name: Setup environment
description: Setup node & package manager, checkout code
runs:
  using: "composite"
  steps:
    # Workaround for dubious ownership problem inside a containerized workflow
    #
    # See https://github.com/actions/runner-images/issues/6775
    #
    # A possible solution to investigate is to use the 1001 user
    # https://github.com/actions/runner/issues/2033#issuecomment-1598547465
    - name: Mark workspace directory as safe
      shell: bash
      run: git config --global --add safe.directory ${GITHUB_WORKSPACE}

    - uses: pnpm/action-setup@v2
      name: Install pnpm
      with:
        version: 8
        run_install: false
